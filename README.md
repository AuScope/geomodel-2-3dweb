[![pdm-managed](https://img.shields.io/badge/pdm-managed-blueviolet)](https://pdm.fming.dev)
![Test Status](https://github.com/AuScope/geomodel-2-3dweb/actions/workflows/tests.yml/badge.svg)
[![Coverage Status](https://raw.githubusercontent.com/AuScope/geomodel-2-3dweb/master/test/badge/coverage-badge.svg)]()

# AuScope Geomodels Portal back-end

Generates 3D web versions of geoscience models primarily for AuScope Geomodels website (https://geomodels.auscope.org.au)

The source code for the front-end of AuScope Geomodels is [here](https://github.com/AuScope/geomodelportal)

## Development

Please see development notes [here](https://github.com/AuScope/geomodel-2-3dweb/DEV_NOTES.md)

## Run tests

All tests
```
cd test
./run_test.sh
```

Regression tests
```
pdm run $SHELL
cd test/regression
./run_reg.sh
```

## Workflows

### 'Build API Backend' Workflow

Triggers: manual dispatch, push to master

Function:
  - Make Python API directory
  - Make borehole database
  - Make Python package state files
  - All outputs are exported as artifacts

### 'Build Models Backend' Workflow

Triggers: push to master

Function:
  - Make models 3d web assets
  - Web assets are exported as artifacts

### 'Release Backend' Workflow

Triggers: Push to a PORTAL_RELEASE_* tag

Function:
  - Creates a backend release
  - Adds the files from the latest successful 'Build API Backend' action to the release
  - Add model web assets from the latest successful 'Build Models Backend' action to the release 

### 'Pages Build Deployment' Workflow

Triggers: dynamic

Function:
  - Creates documentation deployed to https://auscope.github.io/geomodel-2-3dweb/

### 'Testing' Workflow

Triggers: Push to master, pull_request to master

Function:
  - Runs all the unit and regression tests


## Release Procedure

1. Tag with "PORTAL_RELEASE_YYYYMMDD" annotated tag
```
git tag -a PORTAL_RELEASE_20241223 -m "December 2024 Release"
git push --tags origin master
```
2. The 'Release Backend' action will create a release at this tag

**NB:** This action creates a release from the latest **completed** build actions.
The build actions can take some time, so do not create a tag until the build actions are complete.

## Code Documentation

Autogenerated Source Code Documentation is available [here](https://auscope.github.io/geomodel-2-3dweb/)

Please see [README](doc_src/README.md) file for documentation generation details.

## Acknowledgements

Funding provided by [AuScope Pty Ltd](https://www.auscope.org.au/)

SKUA/GOCAD software from the [Paradigm Academic Software Program](http://www.pdgm.com/affiliations/academic-software-programs/) was used to view some types of GOCAD object files and produce sample GOCAD OBJECT files used for testing

## Citation

Please cite as:

Fazio, Vincent; Woodcock, Robert (2024): AuScope 3D Geological Models Portal. v1. CSIRO. Service Collection. http://hdl.handle.net/102.100.100/609085?index=1
